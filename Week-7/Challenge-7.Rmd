---
title: "Challenge-7"
author: "Loy Yee Keen"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Data: Palmer Penguins

Measurements for penguin species, island in Palmer Archipelago, size (flipper length, body mass, bill dimensions), and gender.

```{r, eval=TRUE, echo=TRUE}
library(tidyverse) #load tidyverse
library(palmerpenguins) #load data
glimpse(penguins) #show columns of data stacked on top of one another
```

# Palmer Penguins: Plot recreation

a. Start with the penguins data frame

```{r, eval=TRUE, echo=TRUE}
ggplot(data = penguins) #plot data
```

b. Map bill depth to the x-axis

```{r, eval=TRUE, echo=TRUE}
ggplot(data = penguins,
mapping = aes(x = bill_depth_mm))
#plot data with x axis as bill depth 
```

c. Map bill depth to the y-axis

```{r, eval=TRUE, echo=TRUE}
ggplot(data = penguins,
mapping = aes(x = bill_depth_mm,
y = bill_length_mm)) 
#plot data with x axis as bill depth and y axis is bill length
```

d. Represent each observation with a point

```{r, eval=TRUE, echo=TRUE} 
ggplot(data = penguins,
mapping = aes(x = bill_depth_mm,
y = bill_length_mm)) +
geom_point()
#plot points
```

e. Map species to the colour of each point

```{r, eval=TRUE, echo=TRUE}
ggplot(data = penguins,
mapping = aes(x = bill_depth_mm,
y = bill_length_mm,
colour = species)) +
geom_point() 
#colour the point according to species
```

f. Title the plot "Bill depth and length"

```{r, eval=TRUE, echo=TRUE}
ggplot(data = penguins,
mapping = aes(x = bill_depth_mm,
y = bill_length_mm,
colour = species)) +
geom_point() +
labs(title = "Bill depth and length")
#title the plot
```

g. Add the subtitle "Dimensions for Adelie, Chinstrap, and Gentoo Penguins"

```{r, eval=TRUE, echo=TRUE}
ggplot(data = penguins,
mapping = aes(x = bill_depth_mm,
y = bill_length_mm,
colour = species)) +
geom_point() +
labs(title = "Bill depth and length",
subtitle = "Dimensions for Adelie,
Chinstrap, and Gentoo Penguins")
#add subtitle
```

h. Label the x and y axes as "Bill depth (mm)" and "Bill length (mm)", respectively

```{r, eval=TRUE, echo=TRUE}
ggplot(data = penguins,
 mapping = aes(x = bill_depth_mm,
 y = bill_length_mm,
 colour = species)) +
 geom_point() +
 labs(title = "Bill depth and length",
subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
 x = "Bill depth (mm)",
 y = "Bill length (mm)")
#label x and y axis
```

i. Label the legend "Species"

```{r, eval=TRUE, echo=TRUE} 
ggplot(data = penguins,
 mapping = aes(x = bill_depth_mm,
 y = bill_length_mm,
 colour = species)) +
 geom_point() +
 labs(title = "Bill depth and length",
 subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
 x = "Bill depth (mm)", y = "Bill length (mm)",
 colour = "Species")
#label legend
```

j. Add a caption for the data source

```{r, eval=TRUE, echo=TRUE}
ggplot(data = penguins,
 mapping = aes(x = bill_depth_mm,
 y = bill_length_mm,
 colour = species)) +
 geom_point() +
 labs(title = "Bill depth and length",
 subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
 x = "Bill depth (mm)", y = "Bill length (mm)",
 colour = "Species",
 caption = "Source: Palmer Station LTER/palmerpenguin.package")
#add caption
```

k. Finally, use a discrete colour scale that is designed to be perceived by viewers with common forms of colour blindness.

```{r, eval=TRUE, echo=TRUE} 
ggplot(data = penguins,
 mapping = aes(x = bill_depth_mm,
 y = bill_length_mm,
 colour = species)) +
 geom_point() +
 labs(title = "Bill depth and length",
 subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
 x = "Bill depth (mm)", y = "Bill length (mm)",
 colour = "Species",
 caption = "Source: Palmer Station LTER/palmerpenguin.package") +
 scale_colour_viridis_d()
#change colour scale of points
```
Can omit the names of first two arguments when building plots with ggplot()

```{r, eval=TRUE, echo=TRUE}
#first way of writing the code
ggplot(data = penguins,
 mapping = aes(x = bill_depth_mm,
 y = bill_length_mm,
 colour = species)) +
 geom_point() +
 scale_colour_viridis_d()
```

vs

```{r, eval=TRUE, echo=TRUE}
#second way of writing the code
ggplot(penguins) + # Data layer
 aes(x = bill_depth_mm,
 y = bill_length_mm,
 colour = species) + # Aesthetics layer
 geom_point() + # Geometric layer
 scale_colour_viridis_d()
```

vs

```{r, eval=TRUE, echo=FALSE} 
#third way of writing the code
ggplot(penguins,
 aes(x = bill_depth_mm,
 y = bill_length_mm,
 colour = species)) +
 geom_point() +
 scale_colour_viridis_d()
```

# Palmer Penguins: Colour

```{r, eval=TRUE, echo=TRUE}
ggplot(penguins) + aes(x = bill_depth_mm, y = bill_length_mm,
 colour = species) + geom_point() + scale_colour_viridis_d()
#map colour to species
```

# Palmer Penguins: Shape

Island

```{r, eval=TRUE, echo=TRUE}
ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm, colour = species,
 shape = island)) + geom_point() + scale_colour_viridis_d()
#map shape to island
```

Species

```{r, eval=TRUE, echo=TRUE}
ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm, colour = species,
 shape = species)) + geom_point() + scale_colour_viridis_d()
#map shape and colour to species
```

Size

```{r, eval=TRUE, echo=TRUE}
ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm, colour = species, shape = species,
 size = body_mass_g)) + geom_point() + scale_colour_viridis_d()
#map shape and colour to size
```

# Alpha

```{r, eval=TRUE, echo=TRUE} 
ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm, colour = species,
 shape = species, size = body_mass_g, alpha = flipper_length_mm)) +
 geom_point() + scale_colour_viridis_d()
#add transparency
```

# Mapping vs Setting

Mapping

```{r, eval=TRUE, echo=TRUE}
#map size and transparency according o bill length and body length respectively
ggplot(penguins) +
 aes(x = bill_depth_mm,
 y = bill_length_mm,
 size = body_mass_g,
 alpha = flipper_length_mm) +
 geom_point()
```

Setting

```{r, eval=TRUE, echo=TRUE}
#set point size = 2 and transparency to 0.5
ggplot(penguins) +
 aes(x = bill_depth_mm,
 y = bill_length_mm) +
 geom_point(size = 2, alpha = 0.5)
```

# Faceting

```{r, eval=TRUE, echo=TRUE}
ggplot(penguins) +
 aes(x = bill_depth_mm,
 y = bill_length_mm) +
 geom_point() +
 facet_grid(species ~ island)
#separate the plot according to each species against each island 
```

```{r, eval=TRUE, echo=TRUE}
ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm)) + geom_point() +
 facet_grid(species ~ sex)
#separate the plot according to each species against each gender
```

```{r, eval=TRUE, echo=TRUE}
ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm)) + geom_point() +
 facet_grid(sex ~ species)
#separate the plot according to each gender against each species
```

```{r, eval=TRUE, echo=TRUE}
ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm)) + geom_point() +
 facet_wrap(~ species)
#separate the plot according to species
```

```{r, eval=TRUE, echo=TRUE}
ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm)) + geom_point() +
 facet_wrap(~ species, ncol = 2)
#separate the plot according by each species, in 2 columns
```

```{r, eval=TRUE, echo=TRUE}
ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm)) + geom_point() +
 facet_grid(. ~ species)
#use facet_grid to separate the plot by each species. "." is used to replace the y variable in the facet_grid function
```

```{r, eval=TRUE, echo=TRUE}
ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm, color = species)) +
 geom_point() + facet_grid(species ~ sex) + scale_color_viridis_d()
##separate the plot according to each species against gender colour each species
```

```{r, eval=TRUE, echo=TRUE}
ggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm, color = species)) +
 geom_point() + facet_grid(species ~ sex) + scale_color_viridis_d() +
 guides(color = "none") #remove colour legend
```

# Data 2: Lending Club

Take a peek at data

```{r, eval=TRUE, echo=TRUE}
library(openintro) #load package openintro
glimpse(loans_full_schema) #see the columns of dataset stacked on top of one another
```

Selected variables

```{r, eval=TRUE, echo=TRUE}
loans <- loans_full_schema %>%
 select(loan_amount, interest_rate, term, grade,
 state, annual_income, homeownership, debt_to_income) #select columns loan_amount, interest_rate, term, grade, state, annual_income, homeownership and debt_to_income
glimpse(loans) #see the columns of loans dataset stacked on top of one another
```

# Histogram

```{r, eval=TRUE, echo=TRUE}
ggplot(loans) + aes(x = loan_amount) +
 geom_histogram()
# plot a histogram of loan amount
```

Set Binwidth to 1000

```{r, eval=TRUE, echo=TRUE}
# binwidth = 1000
ggplot(loans, aes(x = loan_amount)) +
 geom_histogram(binwidth = 1000) #set bidwidth to 1000
```

Set Binwidth to 5000

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = loan_amount)) +
 geom_histogram(binwidth = 5000) #set bidwidth to 5000
```

Set Binwidth to 20000

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = loan_amount)) +
 geom_histogram(binwidth = 20000) #set bidwidth to 20000
```

# Customising Histograms

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = loan_amount)) + geom_histogram(binwidth = 5000) +
 labs(x = "Loan amount ($)", y = "Frequency", title = "Amounts of Lending Club loans") #label x axis as "Loan amount ($)", y axis as "Frequency", set title as "Amounts of Lending Club loans"
```

# Fill with a categorical variable

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = loan_amount, fill = homeownership)) + geom_histogram(binwidth = 5000, alpha = 0.5) +
 labs(x = "Loan amount ($)",y = "Frequency",title = "Amounts of Lending Club loans")
#split ownership by colour 
```

# Facet with a categorical variable

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = loan_amount, fill = homeownership)) + geom_histogram(binwidth = 5000) +
 labs(x = "Loan amount ($)",y = "Frequency",title = "Amounts of Lending Club loans") +
 facet_wrap(~ homeownership, nrow = 3) #plot each type of ownership
```

# Density plot

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = loan_amount)) +
 geom_density() #plot a density plot
```

# Density plots and adjusting bandwidth

Adjust to 0.5

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = loan_amount)) +
 geom_density(adjust = 0.5) #adjust bandwidth to 0.5
```

Adjust to 1

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = loan_amount)) +
 geom_density(adjust = 1) # default bandwidth
```

Adjust to 2

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = loan_amount)) +
 geom_density(adjust = 2) #adjust bandwidth to 2
```

# Customising density plots
 
```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = loan_amount)) +
 geom_density(adjust = 2) +
 labs( x = "Loan amount ($)", y = "Density", title = "Amounts of Lending Club loans" ) #
```

# Adding a categorical variable

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = loan_amount, fill = homeownership)) +
 geom_density(adjust = 2, alpha = 0.5) +
 labs(x = "Loan amount ($)",y = "Density",title = "Amounts of Lending Club loans", fill = "Homeownership") #label x axis as "Loan amount ($)", y axis as "Frequency", set title as "Amounts of Lending Club loans"
```

#Box Plot

Box Plot of Interest Rate

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = interest_rate)) +
 geom_boxplot() #plot a boxplot of interest rate
```

Box Plot of Annual Income

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = annual_income)) +
 geom_boxplot() #plot a boxplot of annual income
```

#Customising Box Plots

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = interest_rate)) +geom_boxplot() +labs(x = "Interest rate (%)",y = NULL,
 title = "Interest rates of Lending Club loans") +
 theme( axis.ticks.y = element_blank(), axis.text.y = element_blank() ) #decrease the tick marks of the x axis to 10
```

#Adding a categoric variable

```{r, eval=TRUE, echo=TRUE}
 #add a categorical variable grade and plot it as the yaxis
ggplot(loans, aes(x = interest_rate,
 y = grade)) + geom_boxplot() +
 labs(x = "Interest rate (%)",y = "Grade",title = "Interest rates of Lending Club loans",subtitle="by grade of loan") 
```

# Scatterplot

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = debt_to_income, y = interest_rate)) +
 geom_point()#plot a scatterplot
```

#Hex Plot

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = debt_to_income, y = interest_rate)) +
 geom_hex() #plot a hex plot
```

```{r, eval=TRUE, echo=TRUE}
ggplot(loans %>% filter(debt_to_income < 100),
 aes(x = debt_to_income, y = interest_rate)) +
 geom_hex() #plot a hex plot for debt_to_income < 100
```
 
# Bar Plot

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = homeownership)) +
 geom_bar() #plot a bar plot
```

Segmented Bar Plot

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = homeownership,
 fill = grade)) + geom_bar() #split each grade by colour 
```

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = homeownership, fill = grade)) +
 geom_bar(position = "fill") #make all the bars the same height so compare the proportion of the grade
```

# Customising Bar Plots

```{r, eval=TRUE, echo=TRUE}
#plot a histogram wih homeownership on the y axis
ggplot(loans, aes(y = homeownership, fill = grade)) + geom_bar(position = "fill") +
labs( x = "Proportion", y = "Homeownership", fill = "Grade", title = "Grades of Lending Club loans", subtitle="and home ownership of lendee") 
#label x and y axis, add title, add subtitle, split each grade by colour
```

# Violin Plots

```{r, eval=TRUE, echo=TRUE}
ggplot(loans, aes(x = homeownership, y = loan_amount)) +
 geom_violin() #plot a violin plot
```

# Ridge Plots

```{r, eval=TRUE, echo=TRUE}
library(ggridges) #load ggridges package
ggplot(loans, aes(x = loan_amount, y = grade, fill = grade, color = grade)) +
 geom_density_ridges(alpha = 0.5) #plot ridge plot
```
